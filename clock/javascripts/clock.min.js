// Generated by CoffeeScript 1.7.1
(function(){var e,t,n,r,i,s,o,u,a=function(e,t){return function(){return e.apply(t,arguments)}},f={}.hasOwnProperty,l=function(e,t){function r(){this.constructor=e}for(var n in t)f.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};n=function(){function e(){this.move=a(this.move,this),this.mouseDown=a(this.mouseDown,this),this.mouseUp=a(this.mouseUp,this),this.init=a(this.init,this)}return e.prototype.offX=null,e.prototype.offY=null,e.prototype.init=function(e){return this.element=e,this.element.addEventListener("mousedown",this.mouseDown,!1),window.addEventListener("mouseup",this.mouseUp,!1)},e.prototype.mouseUp=function(){return window.removeEventListener("mousemove",this.move,!0)},e.prototype.mouseDown=function(e){return this.offY=e.clientY-parseInt(this.element.offsetTop),this.offX=e.clientX-parseInt(this.element.offsetLeft),window.addEventListener("mousemove",this.move,!0)},e.prototype.move=function(e){return this.element.style.position="relative",this.element.style.top=e.clientY-this.offY+"px",this.element.style.left=e.clientX-this.offX+"px"},e}(),e=function(){function e(e){var t;this.dimensions=e,this.bind=a(this.bind,this),this.createClock=a(this.createClock,this),this.container=document.getElementById("clock"),this.container.style.width=""+this.dimensions.width+"px",this.container.style.height=""+this.dimensions.height+"px",t=new n,t.init(this.container)}return e.prototype.context=null,e.prototype.element=null,e.prototype.container=null,e.prototype.createClock=function(){return this.element=document.createElement("canvas"),this.element.width=this.dimensions.width,this.element.height=this.dimensions.height,this.context=this.element.getContext("2d"),this.container.appendChild(this.element)},e.prototype.bind=function(e,t){return this.element.addEventListener(e,t)},e.prototype.trigger=function(e){var t;return document.createEvent?(t=document.createEvent("HTMLEvents"),t.initEvent(e,!0,!0)):(t=document.createEventObject(),t.eventType=e),t.eventName=e,document.createEvent?this.element.dispatchEvent(t):this.element.fireEvent("on"+t.eventType,t)},e}(),u=function(){function e(e,t){this.x=e!=null?e:0,this.y=t!=null?t:0}return e.prototype.x=0,e.prototype.y=0,e}(),t=function(){function e(){}return e.prototype.CalculateSecondVertex=function(e,t,n){var r,i,s;return s=new u,r=t*Math.sin(n*Math.PI/180),i=t*Math.cos(n*Math.PI/180),s.x=e.x-r,s.y=e.y-i,s},e.prototype.drawLine=function(e,t,n){return n==null&&(n=1),can.context.lineWidth=n,can.context.beginPath(),can.context.moveTo(e.x,e.y),can.context.lineTo(t.x,t.y),can.context.strokeStyle=this.color,can.context.stroke()},e}(),s=function(e){function t(){return this.bind=a(this.bind,this),this.trigger=a(this.trigger,this),t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.value=0,t.prototype.origin=null,t.prototype.radius=null,t.prototype.angle=0,t.prototype.width=1,t.prototype.color="#000000",t.prototype.events={minutePassed:"minutePassed",hourPassed:"hourPassed"},t.prototype.trigger=function(e){return can.trigger(e)},t.prototype.bind=function(e,t){return can.bind(e,t)},t}(t),o=function(e){function t(e,t,n){this.origin=e,this.radius=t,this.value=n!=null?n:0,this.update=a(this.update,this),this.angle-=this.value*6}return l(t,e),t.prototype.update=function(){var e;return this.angle===-360&&(this.angle=0,this.trigger(this.events.minutePassed)),this.angle-=6,e=this.CalculateSecondVertex(this.origin,this.radius,this.angle),this.drawLine(this.origin,e,this.width)},t}(s),i=function(e){function t(e,t,n){this.origin=e,this.radius=t,this.value=n!=null?n:0,this.update=a(this.update,this),this.angleUpdate=a(this.angleUpdate,this),this.angle-=this.value*6,this.bind(this.events.minutePassed,this.angleUpdate)}return l(t,e),t.prototype.width=3,t.prototype.color="#522900",t.prototype.angleUpdate=function(){return this.angle-=6,this.trigger(this.events.hourPassed)},t.prototype.update=function(){var e;return this.angle===-360&&(this.angle=0),e=this.CalculateSecondVertex(this.origin,this.radius,this.angle),this.drawLine(this.origin,e,this.width)},t}(s),r=function(e){function t(e,t,n,r){this.origin=e,this.radius=t,this.hourPassed=n,this.minutePassed=r,this.angleUpdate=a(this.angleUpdate,this),this.angle-=this.hourPassed%12*30+this.minutePassed*.5,this.bind(this.events.hourPassed,this.angleUpdate)}return l(t,e),t.prototype.width=3,t.prototype.color="#295266",t.prototype.angleUpdate=function(){return this.angle-=.5},t}(i),window.Clock=function(){function t(e){this.options=e!=null?e:{},this.clear=a(this.clear,this),this.update=a(this.update,this),this.readyImage=a(this.readyImage,this),this.getImage=a(this.getImage,this),this.init=a(this.init,this),typeof this.options.dimensions=="undefined"?this.options.dimensions={height:250,width:250}:this.options.dimensions={height:this.options.dimensions,width:this.options.dimensions},typeof this.options.needles=="undefined"&&(this.options.needles={minutes:90,hour:70,seconds:100}),typeof this.options.img=="undefined"&&(this.options.img="roman"),this.init()}return t.prototype.backGround=null,t.prototype.ready=!1,t.prototype.needles={},t.prototype.init=function(){var t,n;return window.can=new e(this.options.dimensions),can.createClock(),this.backGround=new Image,this.backGround.onload=this.readyImage,this.backGround.src=this.getImage(),t=new u(this.options.dimensions.height/2,this.options.dimensions.width/2),n=new Date,this.needles.seconds=new o(t,this.options.needles.seconds,n.getSeconds()),this.needles.minutes=new i(t,this.options.needles.minutes,n.getMinutes()),this.needles.hours=new r(t,this.options.needles.hour,n.getHours(),n.getMinutes()),this.update(),setInterval(this.update,1e3)},t.prototype.getImage=function(){switch(this.options.img){case"numbers":return"res/numbers.jpg";case"numbers_b":return"res/number_bound.jpg";default:return"res/roman_small.png"}},t.prototype.readyImage=function(){return this.ready=!0},t.prototype.update=function(){if(this.ready)return this.clear(),can.context.drawImage(this.backGround,0,0,this.options.dimensions.height,this.options.dimensions.width),this.needles.seconds.update(),this.needles.minutes.update(),this.needles.hours.update()},t.prototype.clear=function(){return can.element.width=can.element.width},t}()}).call(this);